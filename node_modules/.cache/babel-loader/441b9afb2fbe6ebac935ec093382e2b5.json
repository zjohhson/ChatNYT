{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\n\nconst RuntimeModule = require(\"../RuntimeModule\");\n\nconst Template = require(\"../Template\");\n\nconst {\n  parseVersionRuntimeCode,\n  versionLtRuntimeCode,\n  rangeToStringRuntimeCode,\n  satisfyRuntimeCode\n} = require(\"../util/semver\");\n/** @typedef {import(\"webpack-sources\").Source} Source */\n\n/** @typedef {import(\"../Chunk\")} Chunk */\n\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n\n/** @typedef {import(\"../Compilation\")} Compilation */\n\n/** @typedef {import(\"../Module\")} Module */\n\n/** @typedef {import(\"./ConsumeSharedModule\")} ConsumeSharedModule */\n\n\nclass ConsumeSharedRuntimeModule extends RuntimeModule {\n  /**\n   * @param {ReadonlySet<string>} runtimeRequirements runtime requirements\n   */\n  constructor(runtimeRequirements) {\n    super(\"consumes\", RuntimeModule.STAGE_ATTACH);\n    this._runtimeRequirements = runtimeRequirements;\n  }\n  /**\n   * @returns {string | null} runtime code\n   */\n\n\n  generate() {\n    const compilation =\n    /** @type {Compilation} */\n    this.compilation;\n    const chunkGraph =\n    /** @type {ChunkGraph} */\n    this.chunkGraph;\n    const {\n      runtimeTemplate,\n      codeGenerationResults\n    } = compilation;\n    const chunkToModuleMapping = {};\n    /** @type {Map<string | number, Source>} */\n\n    const moduleIdToSourceMapping = new Map();\n    /** @type {(string | number)[]} */\n\n    const initialConsumes = [];\n    /**\n     *\n     * @param {Iterable<Module>} modules modules\n     * @param {Chunk} chunk the chunk\n     * @param {(string | number)[]} list list of ids\n     */\n\n    const addModules = (modules, chunk, list) => {\n      for (const m of modules) {\n        const module =\n        /** @type {ConsumeSharedModule} */\n        m;\n        const id = chunkGraph.getModuleId(module);\n        list.push(id);\n        moduleIdToSourceMapping.set(id, codeGenerationResults.getSource(module, chunk.runtime, \"consume-shared\"));\n      }\n    };\n\n    for (const chunk of\n    /** @type {Chunk} */\n    this.chunk.getAllAsyncChunks()) {\n      const modules = chunkGraph.getChunkModulesIterableBySourceType(chunk, \"consume-shared\");\n      if (!modules) continue;\n      addModules(modules, chunk, chunkToModuleMapping[chunk.id] = []);\n    }\n\n    for (const chunk of\n    /** @type {Chunk} */\n    this.chunk.getAllInitialChunks()) {\n      const modules = chunkGraph.getChunkModulesIterableBySourceType(chunk, \"consume-shared\");\n      if (!modules) continue;\n      addModules(modules, chunk, initialConsumes);\n    }\n\n    if (moduleIdToSourceMapping.size === 0) return null;\n    return Template.asString([parseVersionRuntimeCode(runtimeTemplate), versionLtRuntimeCode(runtimeTemplate), rangeToStringRuntimeCode(runtimeTemplate), satisfyRuntimeCode(runtimeTemplate), `var ensureExistence = ${runtimeTemplate.basicFunction(\"scopeName, key\", [`var scope = ${RuntimeGlobals.shareScopeMap}[scopeName];`, `if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) throw new Error(\"Shared module \" + key + \" doesn't exist in shared scope \" + scopeName);`, \"return scope;\"])};`, `var findVersion = ${runtimeTemplate.basicFunction(\"scope, key\", [\"var versions = scope[key];\", `var key = Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\"a, b\", [\"return !a || versionLt(a, b) ? b : a;\"])}, 0);`, \"return key && versions[key]\"])};`, `var findSingletonVersionKey = ${runtimeTemplate.basicFunction(\"scope, key\", [\"var versions = scope[key];\", `return Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\"a, b\", [\"return !a || (!versions[a].loaded && versionLt(a, b)) ? b : a;\"])}, 0);`])};`, `var getInvalidSingletonVersionMessage = ${runtimeTemplate.basicFunction(\"scope, key, version, requiredVersion\", [`return \"Unsatisfied version \" + version + \" from \" + (version && scope[key][version].from) + \" of shared singleton module \" + key + \" (required \" + rangeToString(requiredVersion) + \")\"`])};`, `var getSingleton = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"var version = findSingletonVersionKey(scope, key);\", \"return get(scope[key][version]);\"])};`, `var getSingletonVersion = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"var version = findSingletonVersionKey(scope, key);\", \"if (!satisfy(requiredVersion, version)) warn(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\", \"return get(scope[key][version]);\"])};`, `var getStrictSingletonVersion = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"var version = findSingletonVersionKey(scope, key);\", \"if (!satisfy(requiredVersion, version)) \" + \"throw new Error(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\", \"return get(scope[key][version]);\"])};`, `var findValidVersion = ${runtimeTemplate.basicFunction(\"scope, key, requiredVersion\", [\"var versions = scope[key];\", `var key = Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\"a, b\", [\"if (!satisfy(requiredVersion, b)) return a;\", \"return !a || versionLt(a, b) ? b : a;\"])}, 0);`, \"return key && versions[key]\"])};`, `var getInvalidVersionMessage = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"var versions = scope[key];\", 'return \"No satisfying version (\" + rangeToString(requiredVersion) + \") of shared module \" + key + \" found in shared scope \" + scopeName + \".\\\\n\" +', `\\t\"Available versions: \" + Object.keys(versions).map(${runtimeTemplate.basicFunction(\"key\", ['return key + \" from \" + versions[key].from;'])}).join(\", \");`])};`, `var getValidVersion = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"var entry = findValidVersion(scope, key, requiredVersion);\", \"if(entry) return get(entry);\", \"throw new Error(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\"])};`, `var warn = ${compilation.outputOptions.ignoreBrowserWarnings ? runtimeTemplate.basicFunction(\"\", \"\") : runtimeTemplate.basicFunction(\"msg\", ['if (typeof console !== \"undefined\" && console.warn) console.warn(msg);'])};`, `var warnInvalidVersion = ${runtimeTemplate.basicFunction(\"scope, scopeName, key, requiredVersion\", [\"warn(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\"])};`, `var get = ${runtimeTemplate.basicFunction(\"entry\", [\"entry.loaded = 1;\", \"return entry.get()\"])};`, `var init = ${runtimeTemplate.returningFunction(Template.asString([\"function(scopeName, a, b, c) {\", Template.indent([`var promise = ${RuntimeGlobals.initializeSharing}(scopeName);`, `if (promise && promise.then) return promise.then(fn.bind(fn, scopeName, ${RuntimeGlobals.shareScopeMap}[scopeName], a, b, c));`, `return fn(scopeName, ${RuntimeGlobals.shareScopeMap}[scopeName], a, b, c);`]), \"}\"]), \"fn\")};`, \"\", `var load = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key\", [\"ensureExistence(scopeName, key);\", \"return get(findVersion(scope, key));\"])});`, `var loadFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, fallback\", [`return scope && ${RuntimeGlobals.hasOwnProperty}(scope, key) ? get(findVersion(scope, key)) : fallback();`])});`, `var loadVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version\", [\"ensureExistence(scopeName, key);\", \"return get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\"])});`, `var loadSingleton = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key\", [\"ensureExistence(scopeName, key);\", \"return getSingleton(scope, scopeName, key);\"])});`, `var loadSingletonVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version\", [\"ensureExistence(scopeName, key);\", \"return getSingletonVersion(scope, scopeName, key, version);\"])});`, `var loadStrictVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version\", [\"ensureExistence(scopeName, key);\", \"return getValidVersion(scope, scopeName, key, version);\"])});`, `var loadStrictSingletonVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version\", [\"ensureExistence(scopeName, key);\", \"return getStrictSingletonVersion(scope, scopeName, key, version);\"])});`, `var loadVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version, fallback\", [`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`, \"return get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\"])});`, `var loadSingletonFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, fallback\", [`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`, \"return getSingleton(scope, scopeName, key);\"])});`, `var loadSingletonVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version, fallback\", [`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`, \"return getSingletonVersion(scope, scopeName, key, version);\"])});`, `var loadStrictVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version, fallback\", [`var entry = scope && ${RuntimeGlobals.hasOwnProperty}(scope, key) && findValidVersion(scope, key, version);`, `return entry ? get(entry) : fallback();`])});`, `var loadStrictSingletonVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\"scopeName, scope, key, version, fallback\", [`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`, \"return getStrictSingletonVersion(scope, scopeName, key, version);\"])});`, \"var installedModules = {};\", \"var moduleToHandlerMapping = {\", Template.indent(Array.from(moduleIdToSourceMapping, _ref => {\n      let [key, source] = _ref;\n      return `${JSON.stringify(key)}: ${source.source()}`;\n    }).join(\",\\n\")), \"};\", initialConsumes.length > 0 ? Template.asString([`var initialConsumes = ${JSON.stringify(initialConsumes)};`, `initialConsumes.forEach(${runtimeTemplate.basicFunction(\"id\", [`${RuntimeGlobals.moduleFactories}[id] = ${runtimeTemplate.basicFunction(\"module\", [\"// Handle case when module is used sync\", \"installedModules[id] = 0;\", `delete ${RuntimeGlobals.moduleCache}[id];`, \"var factory = moduleToHandlerMapping[id]();\", 'if(typeof factory !== \"function\") throw new Error(\"Shared module is not available for eager consumption: \" + id);', `module.exports = factory();`])}`])});`]) : \"// no consumes in initial chunks\", this._runtimeRequirements.has(RuntimeGlobals.ensureChunkHandlers) ? Template.asString([`var chunkMapping = ${JSON.stringify(chunkToModuleMapping, null, \"\\t\")};`, `${RuntimeGlobals.ensureChunkHandlers}.consumes = ${runtimeTemplate.basicFunction(\"chunkId, promises\", [`if(${RuntimeGlobals.hasOwnProperty}(chunkMapping, chunkId)) {`, Template.indent([`chunkMapping[chunkId].forEach(${runtimeTemplate.basicFunction(\"id\", [`if(${RuntimeGlobals.hasOwnProperty}(installedModules, id)) return promises.push(installedModules[id]);`, `var onFactory = ${runtimeTemplate.basicFunction(\"factory\", [\"installedModules[id] = 0;\", `${RuntimeGlobals.moduleFactories}[id] = ${runtimeTemplate.basicFunction(\"module\", [`delete ${RuntimeGlobals.moduleCache}[id];`, \"module.exports = factory();\"])}`])};`, `var onError = ${runtimeTemplate.basicFunction(\"error\", [\"delete installedModules[id];\", `${RuntimeGlobals.moduleFactories}[id] = ${runtimeTemplate.basicFunction(\"module\", [`delete ${RuntimeGlobals.moduleCache}[id];`, \"throw error;\"])}`])};`, \"try {\", Template.indent([\"var promise = moduleToHandlerMapping[id]();\", \"if(promise.then) {\", Template.indent(\"promises.push(installedModules[id] = promise.then(onFactory)['catch'](onError));\"), \"} else onFactory(promise);\"]), \"} catch(e) { onError(e); }\"])});`]), \"}\"])}`]) : \"// no chunk loading of consumes\"]);\n  }\n\n}\n\nmodule.exports = ConsumeSharedRuntimeModule;","map":{"version":3,"sources":["/Users/zachjohnson/Desktop/ChatNYT/node_modules/webpack/lib/sharing/ConsumeSharedRuntimeModule.js"],"names":["RuntimeGlobals","require","RuntimeModule","Template","parseVersionRuntimeCode","versionLtRuntimeCode","rangeToStringRuntimeCode","satisfyRuntimeCode","ConsumeSharedRuntimeModule","constructor","runtimeRequirements","STAGE_ATTACH","_runtimeRequirements","generate","compilation","chunkGraph","runtimeTemplate","codeGenerationResults","chunkToModuleMapping","moduleIdToSourceMapping","Map","initialConsumes","addModules","modules","chunk","list","m","module","id","getModuleId","push","set","getSource","runtime","getAllAsyncChunks","getChunkModulesIterableBySourceType","getAllInitialChunks","size","asString","basicFunction","shareScopeMap","hasOwnProperty","outputOptions","ignoreBrowserWarnings","returningFunction","indent","initializeSharing","Array","from","key","source","JSON","stringify","join","length","moduleFactories","moduleCache","has","ensureChunkHandlers","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst RuntimeModule = require(\"../RuntimeModule\");\nconst Template = require(\"../Template\");\nconst {\n\tparseVersionRuntimeCode,\n\tversionLtRuntimeCode,\n\trangeToStringRuntimeCode,\n\tsatisfyRuntimeCode\n} = require(\"../util/semver\");\n\n/** @typedef {import(\"webpack-sources\").Source} Source */\n/** @typedef {import(\"../Chunk\")} Chunk */\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n/** @typedef {import(\"../Compilation\")} Compilation */\n/** @typedef {import(\"../Module\")} Module */\n/** @typedef {import(\"./ConsumeSharedModule\")} ConsumeSharedModule */\n\nclass ConsumeSharedRuntimeModule extends RuntimeModule {\n\t/**\n\t * @param {ReadonlySet<string>} runtimeRequirements runtime requirements\n\t */\n\tconstructor(runtimeRequirements) {\n\t\tsuper(\"consumes\", RuntimeModule.STAGE_ATTACH);\n\t\tthis._runtimeRequirements = runtimeRequirements;\n\t}\n\n\t/**\n\t * @returns {string | null} runtime code\n\t */\n\tgenerate() {\n\t\tconst compilation = /** @type {Compilation} */ (this.compilation);\n\t\tconst chunkGraph = /** @type {ChunkGraph} */ (this.chunkGraph);\n\t\tconst { runtimeTemplate, codeGenerationResults } = compilation;\n\t\tconst chunkToModuleMapping = {};\n\t\t/** @type {Map<string | number, Source>} */\n\t\tconst moduleIdToSourceMapping = new Map();\n\t\t/** @type {(string | number)[]} */\n\t\tconst initialConsumes = [];\n\t\t/**\n\t\t *\n\t\t * @param {Iterable<Module>} modules modules\n\t\t * @param {Chunk} chunk the chunk\n\t\t * @param {(string | number)[]} list list of ids\n\t\t */\n\t\tconst addModules = (modules, chunk, list) => {\n\t\t\tfor (const m of modules) {\n\t\t\t\tconst module = /** @type {ConsumeSharedModule} */ (m);\n\t\t\t\tconst id = chunkGraph.getModuleId(module);\n\t\t\t\tlist.push(id);\n\t\t\t\tmoduleIdToSourceMapping.set(\n\t\t\t\t\tid,\n\t\t\t\t\tcodeGenerationResults.getSource(\n\t\t\t\t\t\tmodule,\n\t\t\t\t\t\tchunk.runtime,\n\t\t\t\t\t\t\"consume-shared\"\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t\tfor (const chunk of /** @type {Chunk} */ (this.chunk).getAllAsyncChunks()) {\n\t\t\tconst modules = chunkGraph.getChunkModulesIterableBySourceType(\n\t\t\t\tchunk,\n\t\t\t\t\"consume-shared\"\n\t\t\t);\n\t\t\tif (!modules) continue;\n\t\t\taddModules(modules, chunk, (chunkToModuleMapping[chunk.id] = []));\n\t\t}\n\t\tfor (const chunk of /** @type {Chunk} */ (\n\t\t\tthis.chunk\n\t\t).getAllInitialChunks()) {\n\t\t\tconst modules = chunkGraph.getChunkModulesIterableBySourceType(\n\t\t\t\tchunk,\n\t\t\t\t\"consume-shared\"\n\t\t\t);\n\t\t\tif (!modules) continue;\n\t\t\taddModules(modules, chunk, initialConsumes);\n\t\t}\n\t\tif (moduleIdToSourceMapping.size === 0) return null;\n\t\treturn Template.asString([\n\t\t\tparseVersionRuntimeCode(runtimeTemplate),\n\t\t\tversionLtRuntimeCode(runtimeTemplate),\n\t\t\trangeToStringRuntimeCode(runtimeTemplate),\n\t\t\tsatisfyRuntimeCode(runtimeTemplate),\n\t\t\t`var ensureExistence = ${runtimeTemplate.basicFunction(\"scopeName, key\", [\n\t\t\t\t`var scope = ${RuntimeGlobals.shareScopeMap}[scopeName];`,\n\t\t\t\t`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) throw new Error(\"Shared module \" + key + \" doesn't exist in shared scope \" + scopeName);`,\n\t\t\t\t\"return scope;\"\n\t\t\t])};`,\n\t\t\t`var findVersion = ${runtimeTemplate.basicFunction(\"scope, key\", [\n\t\t\t\t\"var versions = scope[key];\",\n\t\t\t\t`var key = Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\n\t\t\t\t\t\"a, b\",\n\t\t\t\t\t[\"return !a || versionLt(a, b) ? b : a;\"]\n\t\t\t\t)}, 0);`,\n\t\t\t\t\"return key && versions[key]\"\n\t\t\t])};`,\n\t\t\t`var findSingletonVersionKey = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, key\",\n\t\t\t\t[\n\t\t\t\t\t\"var versions = scope[key];\",\n\t\t\t\t\t`return Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\n\t\t\t\t\t\t\"a, b\",\n\t\t\t\t\t\t[\"return !a || (!versions[a].loaded && versionLt(a, b)) ? b : a;\"]\n\t\t\t\t\t)}, 0);`\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getInvalidSingletonVersionMessage = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, key, version, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t`return \"Unsatisfied version \" + version + \" from \" + (version && scope[key][version].from) + \" of shared singleton module \" + key + \" (required \" + rangeToString(requiredVersion) + \")\"`\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getSingleton = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var version = findSingletonVersionKey(scope, key);\",\n\t\t\t\t\t\"return get(scope[key][version]);\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getSingletonVersion = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var version = findSingletonVersionKey(scope, key);\",\n\t\t\t\t\t\"if (!satisfy(requiredVersion, version)) warn(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\",\n\t\t\t\t\t\"return get(scope[key][version]);\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getStrictSingletonVersion = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var version = findSingletonVersionKey(scope, key);\",\n\t\t\t\t\t\"if (!satisfy(requiredVersion, version)) \" +\n\t\t\t\t\t\t\"throw new Error(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\",\n\t\t\t\t\t\"return get(scope[key][version]);\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var findValidVersion = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var versions = scope[key];\",\n\t\t\t\t\t`var key = Object.keys(versions).reduce(${runtimeTemplate.basicFunction(\n\t\t\t\t\t\t\"a, b\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"if (!satisfy(requiredVersion, b)) return a;\",\n\t\t\t\t\t\t\t\"return !a || versionLt(a, b) ? b : a;\"\n\t\t\t\t\t\t]\n\t\t\t\t\t)}, 0);`,\n\t\t\t\t\t\"return key && versions[key]\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getInvalidVersionMessage = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var versions = scope[key];\",\n\t\t\t\t\t'return \"No satisfying version (\" + rangeToString(requiredVersion) + \") of shared module \" + key + \" found in shared scope \" + scopeName + \".\\\\n\" +',\n\t\t\t\t\t`\\t\"Available versions: \" + Object.keys(versions).map(${runtimeTemplate.basicFunction(\n\t\t\t\t\t\t\"key\",\n\t\t\t\t\t\t['return key + \" from \" + versions[key].from;']\n\t\t\t\t\t)}).join(\", \");`\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var getValidVersion = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"var entry = findValidVersion(scope, key, requiredVersion);\",\n\t\t\t\t\t\"if(entry) return get(entry);\",\n\t\t\t\t\t\"throw new Error(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var warn = ${\n\t\t\t\tcompilation.outputOptions.ignoreBrowserWarnings\n\t\t\t\t\t? runtimeTemplate.basicFunction(\"\", \"\")\n\t\t\t\t\t: runtimeTemplate.basicFunction(\"msg\", [\n\t\t\t\t\t\t\t'if (typeof console !== \"undefined\" && console.warn) console.warn(msg);'\n\t\t\t\t\t  ])\n\t\t\t};`,\n\t\t\t`var warnInvalidVersion = ${runtimeTemplate.basicFunction(\n\t\t\t\t\"scope, scopeName, key, requiredVersion\",\n\t\t\t\t[\n\t\t\t\t\t\"warn(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\"\n\t\t\t\t]\n\t\t\t)};`,\n\t\t\t`var get = ${runtimeTemplate.basicFunction(\"entry\", [\n\t\t\t\t\"entry.loaded = 1;\",\n\t\t\t\t\"return entry.get()\"\n\t\t\t])};`,\n\t\t\t`var init = ${runtimeTemplate.returningFunction(\n\t\t\t\tTemplate.asString([\n\t\t\t\t\t\"function(scopeName, a, b, c) {\",\n\t\t\t\t\tTemplate.indent([\n\t\t\t\t\t\t`var promise = ${RuntimeGlobals.initializeSharing}(scopeName);`,\n\t\t\t\t\t\t`if (promise && promise.then) return promise.then(fn.bind(fn, scopeName, ${RuntimeGlobals.shareScopeMap}[scopeName], a, b, c));`,\n\t\t\t\t\t\t`return fn(scopeName, ${RuntimeGlobals.shareScopeMap}[scopeName], a, b, c);`\n\t\t\t\t\t]),\n\t\t\t\t\t\"}\"\n\t\t\t\t]),\n\t\t\t\t\"fn\"\n\t\t\t)};`,\n\t\t\t\"\",\n\t\t\t`var load = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return get(findVersion(scope, key));\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`return scope && ${RuntimeGlobals.hasOwnProperty}(scope, key) ? get(findVersion(scope, key)) : fallback();`\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadSingleton = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return getSingleton(scope, scopeName, key);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadSingletonVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return getSingletonVersion(scope, scopeName, key, version);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadStrictVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return getValidVersion(scope, scopeName, key, version);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadStrictSingletonVersionCheck = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version\",\n\t\t\t\t[\n\t\t\t\t\t\"ensureExistence(scopeName, key);\",\n\t\t\t\t\t\"return getStrictSingletonVersion(scope, scopeName, key, version);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`,\n\t\t\t\t\t\"return get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadSingletonFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`,\n\t\t\t\t\t\"return getSingleton(scope, scopeName, key);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadSingletonVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`,\n\t\t\t\t\t\"return getSingletonVersion(scope, scopeName, key, version);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadStrictVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`var entry = scope && ${RuntimeGlobals.hasOwnProperty}(scope, key) && findValidVersion(scope, key, version);`,\n\t\t\t\t\t`return entry ? get(entry) : fallback();`\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t`var loadStrictSingletonVersionCheckFallback = /*#__PURE__*/ init(${runtimeTemplate.basicFunction(\n\t\t\t\t\"scopeName, scope, key, version, fallback\",\n\t\t\t\t[\n\t\t\t\t\t`if(!scope || !${RuntimeGlobals.hasOwnProperty}(scope, key)) return fallback();`,\n\t\t\t\t\t\"return getStrictSingletonVersion(scope, scopeName, key, version);\"\n\t\t\t\t]\n\t\t\t)});`,\n\t\t\t\"var installedModules = {};\",\n\t\t\t\"var moduleToHandlerMapping = {\",\n\t\t\tTemplate.indent(\n\t\t\t\tArray.from(\n\t\t\t\t\tmoduleIdToSourceMapping,\n\t\t\t\t\t([key, source]) => `${JSON.stringify(key)}: ${source.source()}`\n\t\t\t\t).join(\",\\n\")\n\t\t\t),\n\t\t\t\"};\",\n\n\t\t\tinitialConsumes.length > 0\n\t\t\t\t? Template.asString([\n\t\t\t\t\t\t`var initialConsumes = ${JSON.stringify(initialConsumes)};`,\n\t\t\t\t\t\t`initialConsumes.forEach(${runtimeTemplate.basicFunction(\"id\", [\n\t\t\t\t\t\t\t`${\n\t\t\t\t\t\t\t\tRuntimeGlobals.moduleFactories\n\t\t\t\t\t\t\t}[id] = ${runtimeTemplate.basicFunction(\"module\", [\n\t\t\t\t\t\t\t\t\"// Handle case when module is used sync\",\n\t\t\t\t\t\t\t\t\"installedModules[id] = 0;\",\n\t\t\t\t\t\t\t\t`delete ${RuntimeGlobals.moduleCache}[id];`,\n\t\t\t\t\t\t\t\t\"var factory = moduleToHandlerMapping[id]();\",\n\t\t\t\t\t\t\t\t'if(typeof factory !== \"function\") throw new Error(\"Shared module is not available for eager consumption: \" + id);',\n\t\t\t\t\t\t\t\t`module.exports = factory();`\n\t\t\t\t\t\t\t])}`\n\t\t\t\t\t\t])});`\n\t\t\t\t  ])\n\t\t\t\t: \"// no consumes in initial chunks\",\n\t\t\tthis._runtimeRequirements.has(RuntimeGlobals.ensureChunkHandlers)\n\t\t\t\t? Template.asString([\n\t\t\t\t\t\t`var chunkMapping = ${JSON.stringify(\n\t\t\t\t\t\t\tchunkToModuleMapping,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\"\\t\"\n\t\t\t\t\t\t)};`,\n\t\t\t\t\t\t`${\n\t\t\t\t\t\t\tRuntimeGlobals.ensureChunkHandlers\n\t\t\t\t\t\t}.consumes = ${runtimeTemplate.basicFunction(\"chunkId, promises\", [\n\t\t\t\t\t\t\t`if(${RuntimeGlobals.hasOwnProperty}(chunkMapping, chunkId)) {`,\n\t\t\t\t\t\t\tTemplate.indent([\n\t\t\t\t\t\t\t\t`chunkMapping[chunkId].forEach(${runtimeTemplate.basicFunction(\n\t\t\t\t\t\t\t\t\t\"id\",\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t`if(${RuntimeGlobals.hasOwnProperty}(installedModules, id)) return promises.push(installedModules[id]);`,\n\t\t\t\t\t\t\t\t\t\t`var onFactory = ${runtimeTemplate.basicFunction(\n\t\t\t\t\t\t\t\t\t\t\t\"factory\",\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\"installedModules[id] = 0;\",\n\t\t\t\t\t\t\t\t\t\t\t\t`${\n\t\t\t\t\t\t\t\t\t\t\t\t\tRuntimeGlobals.moduleFactories\n\t\t\t\t\t\t\t\t\t\t\t\t}[id] = ${runtimeTemplate.basicFunction(\"module\", [\n\t\t\t\t\t\t\t\t\t\t\t\t\t`delete ${RuntimeGlobals.moduleCache}[id];`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"module.exports = factory();\"\n\t\t\t\t\t\t\t\t\t\t\t\t])}`\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t)};`,\n\t\t\t\t\t\t\t\t\t\t`var onError = ${runtimeTemplate.basicFunction(\"error\", [\n\t\t\t\t\t\t\t\t\t\t\t\"delete installedModules[id];\",\n\t\t\t\t\t\t\t\t\t\t\t`${\n\t\t\t\t\t\t\t\t\t\t\t\tRuntimeGlobals.moduleFactories\n\t\t\t\t\t\t\t\t\t\t\t}[id] = ${runtimeTemplate.basicFunction(\"module\", [\n\t\t\t\t\t\t\t\t\t\t\t\t`delete ${RuntimeGlobals.moduleCache}[id];`,\n\t\t\t\t\t\t\t\t\t\t\t\t\"throw error;\"\n\t\t\t\t\t\t\t\t\t\t\t])}`\n\t\t\t\t\t\t\t\t\t\t])};`,\n\t\t\t\t\t\t\t\t\t\t\"try {\",\n\t\t\t\t\t\t\t\t\t\tTemplate.indent([\n\t\t\t\t\t\t\t\t\t\t\t\"var promise = moduleToHandlerMapping[id]();\",\n\t\t\t\t\t\t\t\t\t\t\t\"if(promise.then) {\",\n\t\t\t\t\t\t\t\t\t\t\tTemplate.indent(\n\t\t\t\t\t\t\t\t\t\t\t\t\"promises.push(installedModules[id] = promise.then(onFactory)['catch'](onError));\"\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\"} else onFactory(promise);\"\n\t\t\t\t\t\t\t\t\t\t]),\n\t\t\t\t\t\t\t\t\t\t\"} catch(e) { onError(e); }\"\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t)});`\n\t\t\t\t\t\t\t]),\n\t\t\t\t\t\t\t\"}\"\n\t\t\t\t\t\t])}`\n\t\t\t\t  ])\n\t\t\t\t: \"// no chunk loading of consumes\"\n\t\t]);\n\t}\n}\n\nmodule.exports = ConsumeSharedRuntimeModule;\n"]},"metadata":{},"sourceType":"script"}