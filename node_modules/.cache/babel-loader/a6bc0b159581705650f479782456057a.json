{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst HarmonyAcceptDependency = require(\"./HarmonyAcceptDependency\");\n\nconst HarmonyAcceptImportDependency = require(\"./HarmonyAcceptImportDependency\");\n\nconst HarmonyCompatibilityDependency = require(\"./HarmonyCompatibilityDependency\");\n\nconst HarmonyEvaluatedImportSpecifierDependency = require(\"./HarmonyEvaluatedImportSpecifierDependency\");\n\nconst HarmonyExportExpressionDependency = require(\"./HarmonyExportExpressionDependency\");\n\nconst HarmonyExportHeaderDependency = require(\"./HarmonyExportHeaderDependency\");\n\nconst HarmonyExportImportedSpecifierDependency = require(\"./HarmonyExportImportedSpecifierDependency\");\n\nconst HarmonyExportSpecifierDependency = require(\"./HarmonyExportSpecifierDependency\");\n\nconst HarmonyImportSideEffectDependency = require(\"./HarmonyImportSideEffectDependency\");\n\nconst HarmonyImportSpecifierDependency = require(\"./HarmonyImportSpecifierDependency\");\n\nconst {\n  JAVASCRIPT_MODULE_TYPE_AUTO,\n  JAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\n\nconst HarmonyDetectionParserPlugin = require(\"./HarmonyDetectionParserPlugin\");\n\nconst HarmonyExportDependencyParserPlugin = require(\"./HarmonyExportDependencyParserPlugin\");\n\nconst HarmonyImportDependencyParserPlugin = require(\"./HarmonyImportDependencyParserPlugin\");\n\nconst HarmonyTopLevelThisParserPlugin = require(\"./HarmonyTopLevelThisParserPlugin\");\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\n\nconst PLUGIN_NAME = \"HarmonyModulesPlugin\";\n/** @typedef {{ topLevelAwait?: boolean }} HarmonyModulesPluginOptions */\n\nclass HarmonyModulesPlugin {\n  /**\n   * @param {HarmonyModulesPluginOptions} options options\n   */\n  constructor(options) {\n    this.options = options;\n  }\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n\n\n  apply(compiler) {\n    compiler.hooks.compilation.tap(PLUGIN_NAME, (compilation, _ref) => {\n      let {\n        normalModuleFactory\n      } = _ref;\n      compilation.dependencyTemplates.set(HarmonyCompatibilityDependency, new HarmonyCompatibilityDependency.Template());\n      compilation.dependencyFactories.set(HarmonyImportSideEffectDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyImportSideEffectDependency, new HarmonyImportSideEffectDependency.Template());\n      compilation.dependencyFactories.set(HarmonyImportSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyImportSpecifierDependency, new HarmonyImportSpecifierDependency.Template());\n      compilation.dependencyFactories.set(HarmonyEvaluatedImportSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyEvaluatedImportSpecifierDependency, new HarmonyEvaluatedImportSpecifierDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportHeaderDependency, new HarmonyExportHeaderDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportExpressionDependency, new HarmonyExportExpressionDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportSpecifierDependency, new HarmonyExportSpecifierDependency.Template());\n      compilation.dependencyFactories.set(HarmonyExportImportedSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyExportImportedSpecifierDependency, new HarmonyExportImportedSpecifierDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyAcceptDependency, new HarmonyAcceptDependency.Template());\n      compilation.dependencyFactories.set(HarmonyAcceptImportDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyAcceptImportDependency, new HarmonyAcceptImportDependency.Template());\n      /**\n       * @param {Parser} parser parser parser\n       * @param {JavascriptParserOptions} parserOptions parserOptions\n       * @returns {void}\n       */\n\n      const handler = (parser, parserOptions) => {\n        // TODO webpack 6: rename harmony to esm or module\n        if (parserOptions.harmony !== undefined && !parserOptions.harmony) return;\n        new HarmonyDetectionParserPlugin(this.options).apply(parser);\n        new HarmonyImportDependencyParserPlugin(parserOptions).apply(parser);\n        new HarmonyExportDependencyParserPlugin(parserOptions).apply(parser);\n        new HarmonyTopLevelThisParserPlugin().apply(parser);\n      };\n\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_AUTO).tap(PLUGIN_NAME, handler);\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_ESM).tap(PLUGIN_NAME, handler);\n    });\n  }\n\n}\n\nmodule.exports = HarmonyModulesPlugin;","map":{"version":3,"sources":["/Users/zachjohnson/Desktop/ChatNYT/node_modules/webpack/lib/dependencies/HarmonyModulesPlugin.js"],"names":["HarmonyAcceptDependency","require","HarmonyAcceptImportDependency","HarmonyCompatibilityDependency","HarmonyEvaluatedImportSpecifierDependency","HarmonyExportExpressionDependency","HarmonyExportHeaderDependency","HarmonyExportImportedSpecifierDependency","HarmonyExportSpecifierDependency","HarmonyImportSideEffectDependency","HarmonyImportSpecifierDependency","JAVASCRIPT_MODULE_TYPE_AUTO","JAVASCRIPT_MODULE_TYPE_ESM","HarmonyDetectionParserPlugin","HarmonyExportDependencyParserPlugin","HarmonyImportDependencyParserPlugin","HarmonyTopLevelThisParserPlugin","PLUGIN_NAME","HarmonyModulesPlugin","constructor","options","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyTemplates","set","Template","dependencyFactories","handler","parser","parserOptions","harmony","undefined","for","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst HarmonyAcceptDependency = require(\"./HarmonyAcceptDependency\");\nconst HarmonyAcceptImportDependency = require(\"./HarmonyAcceptImportDependency\");\nconst HarmonyCompatibilityDependency = require(\"./HarmonyCompatibilityDependency\");\nconst HarmonyEvaluatedImportSpecifierDependency = require(\"./HarmonyEvaluatedImportSpecifierDependency\");\nconst HarmonyExportExpressionDependency = require(\"./HarmonyExportExpressionDependency\");\nconst HarmonyExportHeaderDependency = require(\"./HarmonyExportHeaderDependency\");\nconst HarmonyExportImportedSpecifierDependency = require(\"./HarmonyExportImportedSpecifierDependency\");\nconst HarmonyExportSpecifierDependency = require(\"./HarmonyExportSpecifierDependency\");\nconst HarmonyImportSideEffectDependency = require(\"./HarmonyImportSideEffectDependency\");\nconst HarmonyImportSpecifierDependency = require(\"./HarmonyImportSpecifierDependency\");\n\nconst {\n\tJAVASCRIPT_MODULE_TYPE_AUTO,\n\tJAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\nconst HarmonyDetectionParserPlugin = require(\"./HarmonyDetectionParserPlugin\");\nconst HarmonyExportDependencyParserPlugin = require(\"./HarmonyExportDependencyParserPlugin\");\nconst HarmonyImportDependencyParserPlugin = require(\"./HarmonyImportDependencyParserPlugin\");\nconst HarmonyTopLevelThisParserPlugin = require(\"./HarmonyTopLevelThisParserPlugin\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\nconst PLUGIN_NAME = \"HarmonyModulesPlugin\";\n\n/** @typedef {{ topLevelAwait?: boolean }} HarmonyModulesPluginOptions */\n\nclass HarmonyModulesPlugin {\n\t/**\n\t * @param {HarmonyModulesPluginOptions} options options\n\t */\n\tconstructor(options) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\tPLUGIN_NAME,\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyCompatibilityDependency,\n\t\t\t\t\tnew HarmonyCompatibilityDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyImportSideEffectDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyImportSideEffectDependency,\n\t\t\t\t\tnew HarmonyImportSideEffectDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyImportSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyImportSpecifierDependency,\n\t\t\t\t\tnew HarmonyImportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyEvaluatedImportSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyEvaluatedImportSpecifierDependency,\n\t\t\t\t\tnew HarmonyEvaluatedImportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportHeaderDependency,\n\t\t\t\t\tnew HarmonyExportHeaderDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportExpressionDependency,\n\t\t\t\t\tnew HarmonyExportExpressionDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportSpecifierDependency,\n\t\t\t\t\tnew HarmonyExportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyExportImportedSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportImportedSpecifierDependency,\n\t\t\t\t\tnew HarmonyExportImportedSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyAcceptDependency,\n\t\t\t\t\tnew HarmonyAcceptDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyAcceptImportDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyAcceptImportDependency,\n\t\t\t\t\tnew HarmonyAcceptImportDependency.Template()\n\t\t\t\t);\n\n\t\t\t\t/**\n\t\t\t\t * @param {Parser} parser parser parser\n\t\t\t\t * @param {JavascriptParserOptions} parserOptions parserOptions\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst handler = (parser, parserOptions) => {\n\t\t\t\t\t// TODO webpack 6: rename harmony to esm or module\n\t\t\t\t\tif (parserOptions.harmony !== undefined && !parserOptions.harmony)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tnew HarmonyDetectionParserPlugin(this.options).apply(parser);\n\t\t\t\t\tnew HarmonyImportDependencyParserPlugin(parserOptions).apply(parser);\n\t\t\t\t\tnew HarmonyExportDependencyParserPlugin(parserOptions).apply(parser);\n\t\t\t\t\tnew HarmonyTopLevelThisParserPlugin().apply(parser);\n\t\t\t\t};\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_AUTO)\n\t\t\t\t\t.tap(PLUGIN_NAME, handler);\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_ESM)\n\t\t\t\t\t.tap(PLUGIN_NAME, handler);\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = HarmonyModulesPlugin;\n"]},"metadata":{},"sourceType":"script"}